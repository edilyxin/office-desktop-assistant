# 办公桌面助手 - 功能开发记录

## 1. 项目概述
办公桌面助手是一个基于PaddleOCR-vl API开发的桌面OCR工具，支持截图识别和文件上传识别，识别结果可复制到剪贴板或保存为Markdown文件。

## 2. 功能列表

| 功能名称 | 描述 | 实现日期 | 状态 |
|---------|------|---------|------|
| 项目初始化 | 创建项目目录结构 | 2025-12-01 | ✅ 已完成 |
| 虚拟环境配置 | 创建并配置Python虚拟环境 | 2025-12-01 | ✅ 已完成 |
| 依赖管理 | 安装和管理第三方依赖包 | 2025-12-01 | ✅ 已完成 |
| 配置文件管理 | 管理API密钥和配置参数 | 2025-12-01 | ✅ 已完成 |
| OCR API调用 | 调用PaddleOCR-vl API进行内容识别 | 2025-12-01 | ✅ 已完成 |
| 截图功能 | 支持全屏截图和区域截图 | 2025-12-01 | ✅ 已完成 |
| 文件上传 | 支持图片和PDF文件上传 | 2025-12-01 | ✅ 已完成 |
| 剪贴板复制 | 识别结果一键复制到剪贴板 | 2025-12-01 | ✅ 已完成 |
| Markdown保存 | 识别结果保存为Markdown文件 | 2025-12-01 | ✅ 已完成 |
| 桌面GUI界面 | 创建友好的桌面应用界面 | 2025-12-01 | ✅ 已完成 |
| Markdown渲染 | 美观的识别结果Markdown渲染 | 2025-12-01 | ✅ 已完成 |
| 图片等比例缩放 | 图片显示支持等比例缩放 | 2025-12-01 | ✅ 已完成 |
| 图片本地存储 | 自动保存识别结果中的图片 | 2025-12-01 | ✅ 已完成 |
| 日志记录 | 详细的操作日志记录 | 2025-12-01 | ✅ 已完成 |
| visualize参数支持 | API调用添加visualize参数 | 2025-12-01 | ✅ 已完成 |
| prettifyMarkdown参数支持 | API调用添加prettifyMarkdown参数 | 2025-12-01 | ✅ 已完成 |

## 3. 功能详细描述

### 3.1 项目初始化
- 创建了清晰的项目目录结构
- 包括src、config、logs、imgs等目录
- 建立了模块化的代码结构

### 3.2 虚拟环境配置
- 使用Python venv创建虚拟环境
- 隔离项目依赖，避免冲突
- 支持跨平台使用

### 3.3 依赖管理
- 安装了必要的第三方依赖：requests、pyqt5、pillow、pyperclip、mss、pyyaml、pyqtwebengine
- 生成了requirements.txt文件，方便依赖安装

### 3.4 配置文件管理
- 使用YAML格式的配置文件管理API密钥
- 支持灵活的配置修改
- 配置文件与代码分离，提高安全性

### 3.5 OCR API调用
- 实现了PaddleOCR-vl API的调用功能
- 支持文件和字节流两种识别方式
- 支持多种识别选项：文档方向分类、文档矫正、图表识别
- 添加了prettifyMarkdown和visualize参数支持

### 3.6 截图功能
- 使用mss库实现高效截图
- 支持全屏截图和区域截图
- 提供了直观的截图界面

### 3.7 文件上传
- 支持多种文件格式：png、jpg、jpeg、bmp、gif、tiff、pdf
- 自动验证文件格式
- 支持大文件上传

### 3.8 剪贴板复制
- 一键复制识别结果到剪贴板
- 支持多种操作系统
- 操作便捷，提高工作效率

### 3.9 Markdown保存
- 支持将识别结果保存为Markdown文件
- 自动处理图片下载和保存
- 支持自定义保存路径

### 3.10 桌面GUI界面
- 使用PyQt5实现友好的桌面界面
- 包括功能选择区、识别选项、结果显示区、操作按钮
- 支持窗口大小调整和布局优化

### 3.11 Markdown渲染
- 使用QWebEngineView实现Markdown渲染
- 支持标题、段落、列表、代码块、表格、图片等元素
- 设计了美观的CSS样式

### 3.12 图片等比例缩放
- 实现了图片等比例缩放功能
- 保持图片原始比例，避免变形
- 支持自动调整大小以适应显示区域

### 3.13 图片本地存储
- 自动下载并保存识别结果中的图片
- 保存到本地imgs目录
- 支持替换Markdown中的图片路径为本地路径

### 3.14 日志记录
- 使用Python logging模块实现日志功能
- 支持控制台和文件日志
- 日志级别可配置
- 记录所有关键操作和错误信息

## 4. 版本历史

| 版本 | 日期 | 更新内容 |
|------|------|----------|
| v0.5 | 2025-12-01 | 初始版本，包含所有基本功能 |
| v0.6 | 2025-12-01 | 开始开发Word文件格式自动调整功能，遇到python-docx样式解析问题 |

## 5. 后续计划

| 功能名称 | 描述 | 优先级 | 计划版本 |
|---------|------|--------|----------|
| word自动调整 | 添加word文件的格式自动调整新功能 | 高 | v0.6 |

## 6. 问题记录

| 问题描述 | 影响功能 | 解决方案 | 状态 |
|---------|---------|---------|------|
| python-docx解析Word文档时仅能获取样式名称，无法获取具体样式内容（如字体、字号、行间距等） | Word文件格式自动调整 | 1. 深入研究python-docx API，寻找获取样式详细属性的方法<br>2. 考虑使用python-docx的底层XML访问功能<br>3. 探索其他Word处理库（如python-docx2txt、python-pptx）的可能性<br>4. 实现样式映射机制，将样式名称映射到具体样式属性 | 🔄 研究中 |

## 6. 贡献指南

欢迎对项目进行贡献，包括：

- 修复bug
- 添加新功能
- 退出动作

## 7. 联系方式

如有问题或建议，请联系项目维护者。

## 5. 后续计划

| 功能名称 | 描述 | 优先级 |
|---------|------|--------|
| 区域截图优化 | 优化区域截图的用户体验 | 中 |
| 快捷键支持 | 添加常用操作的快捷键 | 中 |
| 多语言支持 | 支持多种语言的识别和界面 | 低 |
| 批量处理 | 支持批量文件处理 | 高 |
| 结果预览 | 添加识别结果的预览功能 | 中 |

## 6. 贡献指南

欢迎对项目进行贡献，包括：
- 修复bug
- 添加新功能
- 优化代码
- 改进文档

## 7. 联系方式

如有问题或建议，请联系项目维护者。
