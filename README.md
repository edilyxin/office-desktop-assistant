# åŠå…¬æ¡Œé¢åŠ©æ‰‹ / Office Desktop Assistant

[![GitHub license](https://img.shields.io/github/license/edilyxin/office-desktop-assistant)](https://github.com/edilyxin/office-desktop-assistant/blob/main/LICENSE)
[![GitHub stars](https://img.shields.io/github/stars/edilyxin/office-desktop-assistant)](https://github.com/edilyxin/office-desktop-assistant/stargazers)
[![GitHub forks](https://img.shields.io/github/forks/edilyxin/office-desktop-assistant)](https://github.com/edilyxin/office-desktop-assistant/network)
[![GitHub issues](https://img.shields.io/github/issues/edilyxin/office-desktop-assistant)](https://github.com/edilyxin/office-desktop-assistant/issues)

## è¯­è¨€åˆ‡æ¢ / Language Switch

- [ä¸­æ–‡ç‰ˆæœ¬ (Chinese Version)](#ä¸­æ–‡ç‰ˆæœ¬)
- [English Version](#english-version)

---

## ä¸­æ–‡ç‰ˆæœ¬

### é¡¹ç›®æ¦‚è¿°
åŠå…¬æ¡Œé¢åŠ©æ‰‹æ˜¯ä¸€ä¸ªåŸºäºPaddleOCR-vl APIå¼€å‘çš„æ¡Œé¢OCRå·¥å…·ï¼Œæ”¯æŒæˆªå›¾è¯†åˆ«å’Œæ–‡ä»¶ä¸Šä¼ è¯†åˆ«ï¼Œè¯†åˆ«ç»“æœå¯å¤åˆ¶åˆ°å‰ªè´´æ¿æˆ–ä¿å­˜ä¸ºMarkdownæ–‡ä»¶ã€‚

### åŠŸèƒ½ç‰¹æ€§

#### ğŸ“¸ æˆªå›¾è¯†åˆ«
- æ”¯æŒå…¨å±æˆªå›¾å’Œé¼ æ ‡é€‰æ‹©åŒºåŸŸæˆªå›¾
- æˆªå›¾åå®æ—¶æ˜¾ç¤ºåœ¨ç•Œé¢å³ä¾§
- è‡ªåŠ¨è¯†åˆ«å›¾ç‰‡ä¸­çš„æ–‡å­—å’ŒåŒºåŸŸ

#### ğŸ“ æ–‡ä»¶ä¸Šä¼ 
- æ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼ï¼špngã€jpgã€jpegã€bmpã€gifã€tiffã€pdf
- ä¸Šä¼ åå…ˆæ˜¾ç¤ºå›¾ç‰‡ï¼Œå†è¿›è¡Œè¯†åˆ«
- æ”¯æŒå¤§æ–‡ä»¶ä¸Šä¼ 

#### ğŸ“ è¯†åˆ«ç»“æœå¤„ç†
- è¯†åˆ«ç»“æœä»¥Markdownæ ¼å¼æ¸²æŸ“æ˜¾ç¤º
- æ”¯æŒä¸€é”®å¤åˆ¶åˆ°å‰ªè´´æ¿
- æ”¯æŒä¿å­˜ä¸ºMarkdownæ–‡ä»¶
- è¯†åˆ«ç»“æœä¸­çš„å›¾ç‰‡è‡ªåŠ¨ä¿å­˜åˆ°æœ¬åœ°imgsæ–‡ä»¶å¤¹

#### ğŸ“Š å›¾ç‰‡æ˜¾ç¤º
- å³ä¾§æ˜¾ç¤ºè¯†åˆ«çš„å›¾ç‰‡å’Œè¯†åˆ«åˆ°çš„åŒºåŸŸ
- æ”¯æŒå›¾ç‰‡ç­‰æ¯”ä¾‹ç¼©æ”¾
- æ˜¾ç¤ºè¯†åˆ«åŒºåŸŸçš„è¾¹ç•Œæ¡†

#### ğŸ“„ Wordæ–‡ä»¶æ ·å¼è°ƒæ•´ (v0.6å¼€å‘ä¸­)
- æ”¯æŒé€‰æ‹©Wordæ ·å¼æ¨¡æ¿æ–‡ä»¶
- æ”¯æŒä¸Šä¼ ç›®æ ‡Wordæ–‡ä»¶
- åŸºäºæ¨¡æ¿è‡ªåŠ¨è°ƒæ•´ç›®æ ‡æ–‡ä»¶æ ·å¼
- æ”¯æŒå¤šçº§æ ‡é¢˜ã€æ­£æ–‡ã€è¡Œé—´è·ã€æ®µè½ã€è¡¨æ ¼ç­‰æ ·å¼è°ƒæ•´

#### ğŸ“‹ è¯¦ç»†æ—¥å¿—
- å…³é”®åŠ¨ä½œè®°å½•åˆ°æ—¥å¿—æ–‡ä»¶
- Debugä¿¡æ¯è¾“å‡ºåˆ°æ§åˆ¶å°
- æ¨¡æ¿åˆ†æå’Œæ–‡ä»¶å¤„ç†çš„è¯¦ç»†æ—¥å¿—

### æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Python | 3.8+ | å¼€å‘è¯­è¨€ |
| PyQt5 | 5.15+ | GUIæ¡†æ¶ |
| PaddleOCR-vl API | - | OCRè¯†åˆ« |
| requests | 2.31+ | HTTPè¯·æ±‚ |
| pillow | 10.0+ | å›¾åƒå¤„ç† |
| pyperclip | 1.8+ | å‰ªè´´æ¿æ“ä½œ |
| mss | 9.0+ | å±å¹•æˆªå›¾ |
| pyyaml | 6.0+ | é…ç½®æ–‡ä»¶ç®¡ç† |
| pyqtwebengine | 5.15+ | Markdownæ¸²æŸ“ |
| python-docx | 0.8+ | Wordæ–‡æ¡£å¤„ç† |

### å®‰è£…è¯´æ˜

#### 1. å…‹éš†ä»“åº“
```bash
git clone https://github.com/edilyxin/office-desktop-assistant.git
cd office-desktop-assistant
```

#### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
```bash
# Windows
python -m venv venv
venv\Scripts\activate

# macOS/Linux
python3 -m venv venv
source venv/bin/activate
```

#### 3. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

#### 4. é…ç½®APIå¯†é’¥
1. å¤åˆ¶é…ç½®æ–‡ä»¶æ¨¡æ¿ï¼š
   ```bash
   cp config/config.yaml.example config/config.yaml
   ```
2. ç¼–è¾‘`config/config.yaml`æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„PaddleOCR-vl APIå¯†é’¥

### ä½¿ç”¨æ–¹æ³•

#### 1. å¯åŠ¨ç¨‹åº
```bash
python run.py
```

#### 2. æˆªå›¾è¯†åˆ«
1. ç‚¹å‡»"æˆªå›¾è¯†åˆ«"æŒ‰é’®
2. ç”¨é¼ æ ‡æ‹–åŠ¨é€‰æ‹©æˆªå›¾åŒºåŸŸ
3. æ¾å¼€é¼ æ ‡åè‡ªåŠ¨å¼€å§‹è¯†åˆ«
4. åœ¨å³ä¾§æŸ¥çœ‹è¯†åˆ«ç»“æœ

#### 3. æ–‡ä»¶ä¸Šä¼ è¯†åˆ«
1. ç‚¹å‡»"ä¸Šä¼ æ–‡ä»¶"æŒ‰é’®
2. é€‰æ‹©è¦è¯†åˆ«çš„å›¾ç‰‡æˆ–PDFæ–‡ä»¶
3. ç­‰å¾…æ–‡ä»¶ä¸Šä¼ å’Œè¯†åˆ«å®Œæˆ
4. åœ¨å³ä¾§æŸ¥çœ‹è¯†åˆ«ç»“æœ

#### 4. å¤„ç†è¯†åˆ«ç»“æœ
- ç‚¹å‡»"å¤åˆ¶åˆ°å‰ªè´´æ¿"æŒ‰é’®ï¼Œå°†è¯†åˆ«ç»“æœå¤åˆ¶åˆ°å‰ªè´´æ¿
- ç‚¹å‡»"ä¿å­˜ä¸ºMarkdown"æŒ‰é’®ï¼Œå°†è¯†åˆ«ç»“æœä¿å­˜ä¸ºMarkdownæ–‡ä»¶

#### 5. Wordæ–‡ä»¶æ ·å¼è°ƒæ•´
1. åˆ‡æ¢åˆ°"æ–‡ä»¶æ ·å¼"æ ‡ç­¾é¡µ
2. ç‚¹å‡»"é€‰æ‹©æ¨¡æ¿"æŒ‰é’®ï¼Œé€‰æ‹©Wordæ ·å¼æ¨¡æ¿æ–‡ä»¶
3. ç‚¹å‡»"ä¸Šä¼ æ–‡ä»¶"æŒ‰é’®ï¼Œé€‰æ‹©ç›®æ ‡Wordæ–‡ä»¶
4. ç‚¹å‡»"å¼€å§‹å¤„ç†"æŒ‰é’®ï¼Œç­‰å¾…å¤„ç†å®Œæˆ
5. å¤„ç†åçš„æ–‡ä»¶å°†ä¿å­˜åˆ°outputç›®å½•

### é¡¹ç›®ç»“æ„

```
office-desktop-assistant/
â”œâ”€â”€ src/                  # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ main.py           # ä¸»ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ ocr_api.py        # OCR APIè°ƒç”¨æ¨¡å—
â”‚   â”œâ”€â”€ screenshot.py     # æˆªå›¾åŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ config_manager.py # é…ç½®ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ file_utils.py     # æ–‡ä»¶å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ clipboard_manager.py # å‰ªè´´æ¿ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ markdown_manager.py # Markdownå¤„ç†æ¨¡å—
â”‚   â””â”€â”€ log_manager.py    # æ—¥å¿—ç®¡ç†æ¨¡å—
â”œâ”€â”€ config/               # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ config.yaml.example # é…ç½®æ–‡ä»¶æ¨¡æ¿
â”‚   â””â”€â”€ config.yaml       # é…ç½®æ–‡ä»¶ï¼ˆéœ€è‡ªè¡Œåˆ›å»ºï¼‰
â”œâ”€â”€ logs/                 # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”œâ”€â”€ imgs/                 # è¯†åˆ«ç»“æœå›¾ç‰‡ä¿å­˜ç›®å½•
â”œâ”€â”€ output/               # å¤„ç†åçš„æ–‡ä»¶è¾“å‡ºç›®å½•
â”œâ”€â”€ template/             # Wordæ¨¡æ¿æ–‡ä»¶ç›®å½•
â”œâ”€â”€ venv/                 # è™šæ‹Ÿç¯å¢ƒç›®å½•
â”œâ”€â”€ requirements.txt      # ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ run.py                # ç¨‹åºå¯åŠ¨è„šæœ¬
â”œâ”€â”€ FEATURES.md           # åŠŸèƒ½å¼€å‘è®°å½•
â”œâ”€â”€ LICENSE               # è®¸å¯è¯æ–‡ä»¶
â””â”€â”€ README.md             # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

### é…ç½®è¯´æ˜

é…ç½®æ–‡ä»¶`config/config.yaml`åŒ…å«ä»¥ä¸‹å‚æ•°ï¼š

```yaml
api_key: your_api_key_here
api_url: https://paddleocr-vl-api.example.com
use_doc_orientation_classify: true
use_doc_unwarping: true
use_chart_recognition: true
prettifyMarkdown: true
visualize: true
```

### æ—¥å¿—è¯´æ˜

- æ—¥å¿—æ–‡ä»¶ä¿å­˜åœ¨`logs/`ç›®å½•ä¸‹
- æ—¥å¿—çº§åˆ«ï¼šDEBUGã€INFOã€WARNINGã€ERRORã€CRITICAL
- æ§åˆ¶å°è¾“å‡ºDEBUGçº§åˆ«ä»¥ä¸Šçš„æ—¥å¿—
- æ—¥å¿—æ–‡ä»¶è®°å½•INFOçº§åˆ«ä»¥ä¸Šçš„æ—¥å¿—

### ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|----------|
| v0.5 | 2025-12-01 | åˆå§‹ç‰ˆæœ¬ï¼ŒåŒ…å«æ‰€æœ‰åŸºæœ¬åŠŸèƒ½ |
| v0.6 | å¼€å‘ä¸­ | æ·»åŠ Wordæ–‡ä»¶æ ¼å¼è‡ªåŠ¨è°ƒæ•´åŠŸèƒ½ |

### åç»­è®¡åˆ’

| åŠŸèƒ½åç§° | æè¿° | ä¼˜å…ˆçº§ |
|---------|------|--------|
| åŒºåŸŸæˆªå›¾ä¼˜åŒ– | ä¼˜åŒ–åŒºåŸŸæˆªå›¾çš„ç”¨æˆ·ä½“éªŒ | ä¸­ |
| å¿«æ·é”®æ”¯æŒ | æ·»åŠ å¸¸ç”¨æ“ä½œçš„å¿«æ·é”® | ä¸­ |
| å¤šè¯­è¨€æ”¯æŒ | æ”¯æŒå¤šç§è¯­è¨€çš„è¯†åˆ«å’Œç•Œé¢ | ä½ |
| æ‰¹é‡å¤„ç† | æ”¯æŒæ‰¹é‡æ–‡ä»¶å¤„ç† | é«˜ |
| ç»“æœé¢„è§ˆ | æ·»åŠ è¯†åˆ«ç»“æœçš„é¢„è§ˆåŠŸèƒ½ | ä¸­ |

### è´¡çŒ®æŒ‡å—

æ¬¢è¿å¯¹é¡¹ç›®è¿›è¡Œè´¡çŒ®ï¼ŒåŒ…æ‹¬ï¼š
- ä¿®å¤bug
- æ·»åŠ æ–°åŠŸèƒ½
- ä¼˜åŒ–ä»£ç 
- æ”¹è¿›æ–‡æ¡£

### è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»é¡¹ç›®ç»´æŠ¤è€…ï¼š
- GitHub Issuesï¼šhttps://github.com/edilyxin/office-desktop-assistant/issues

---

[åˆ‡æ¢åˆ°è‹±æ–‡ç‰ˆæœ¬](#english-version)

---

## English Version

### Project Overview
Office Desktop Assistant is a desktop OCR tool developed based on PaddleOCR-vl API, supporting screenshot recognition and file upload recognition. Recognition results can be copied to clipboard or saved as Markdown files.

### Features

#### ğŸ“¸ Screenshot Recognition
- Support full-screen screenshot and mouse-selectable area screenshot
- Real-time display of screenshots on the right side of the interface
- Automatic recognition of text and regions in images

#### ğŸ“ File Upload
- Support multiple file formats: png, jpg, jpeg, bmp, gif, tiff, pdf
- Display images first after upload, then perform recognition
- Support large file uploads

#### ğŸ“ Recognition Result Processing
- Recognition results rendered and displayed in Markdown format
- One-click copy to clipboard
- Support saving as Markdown files
- Images in recognition results are automatically saved to local imgs folder

#### ğŸ“Š Image Display
- Display recognized images and recognized regions on the right side
- Support image proportional scaling
- Display bounding boxes of recognized regions

#### ğŸ“„ Word File Style Adjustment (v0.6 in development)
- Support selecting Word style template files
- Support uploading target Word files
- Automatically adjust target file styles based on templates
- Support style adjustment for multi-level headings, body text, line spacing, paragraphs, tables, etc.

#### ğŸ“‹ Detailed Logging
- Key actions recorded to log files
- Debug information output to console
- Detailed logs for template analysis and file processing

### Technology Stack

| Technology | Version | Purpose |
|------------|---------|---------|
| Python | 3.8+ | Development language |
| PyQt5 | 5.15+ | GUI framework |
| PaddleOCR-vl API | - | OCR recognition |
| requests | 2.31+ | HTTP requests |
| pillow | 10.0+ | Image processing |
| pyperclip | 1.8+ | Clipboard operations |
| mss | 9.0+ | Screen capture |
| pyyaml | 6.0+ | Configuration file management |
| pyqtwebengine | 5.15+ | Markdown rendering |
| python-docx | 0.8+ | Word document processing |

### Installation Instructions

#### 1. Clone the Repository
```bash
git clone https://github.com/edilyxin/office-desktop-assistant.git
cd office-desktop-assistant
```

#### 2. Create Virtual Environment
```bash
# Windows
python -m venv venv
venv\Scripts\activate

# macOS/Linux
python3 -m venv venv
source venv/bin/activate
```

#### 3. Install Dependencies
```bash
pip install -r requirements.txt
```

#### 4. Configure API Key
1. Copy the configuration file template:
   ```bash
   cp config/config.yaml.example config/config.yaml
   ```
2. Edit `config/config.yaml` file and fill in your PaddleOCR-vl API key

### Usage

#### 1. Start the Program
```bash
python run.py
```

#### 2. Screenshot Recognition
1. Click the "Screenshot Recognition" button
2. Drag with the mouse to select the screenshot area
3. Automatic recognition starts after releasing the mouse
4. View recognition results on the right side

#### 3. File Upload Recognition
1. Click the "Upload File" button
2. Select the image or PDF file to be recognized
3. Wait for file upload and recognition to complete
4. View recognition results on the right side

#### 4. Process Recognition Results
- Click "Copy to Clipboard" button to copy recognition results to clipboard
- Click "Save as Markdown" button to save recognition results as Markdown files

#### 5. Word File Style Adjustment
1. Switch to the "File Style" tab
2. Click "Select Template" button to select a Word style template file
3. Click "Upload File" button to select the target Word file
4. Click "Start Processing" button and wait for processing to complete
5. Processed files will be saved to the output directory

### Project Structure

```
office-desktop-assistant/
â”œâ”€â”€ src/                  # Source code directory
â”‚   â”œâ”€â”€ main.py           # Main program entry
â”‚   â”œâ”€â”€ ocr_api.py        # OCR API call module
â”‚   â”œâ”€â”€ screenshot.py     # Screenshot function module
â”‚   â”œâ”€â”€ config_manager.py # Configuration management module
â”‚   â”œâ”€â”€ file_utils.py     # File processing module
â”‚   â”œâ”€â”€ clipboard_manager.py # Clipboard management module
â”‚   â”œâ”€â”€ markdown_manager.py # Markdown processing module
â”‚   â””â”€â”€ log_manager.py    # Log management module
â”œâ”€â”€ config/               # Configuration file directory
â”‚   â”œâ”€â”€ config.yaml.example # Configuration file template
â”‚   â””â”€â”€ config.yaml       # Configuration file (need to create by yourself)
â”œâ”€â”€ logs/                 # Log file directory
â”œâ”€â”€ imgs/                 # Recognition result image save directory
â”œâ”€â”€ output/               # Processed file output directory
â”œâ”€â”€ template/             # Word template file directory
â”œâ”€â”€ venv/                 # Virtual environment directory
â”œâ”€â”€ requirements.txt      # Dependency package list
â”œâ”€â”€ run.py                # Program startup script
â”œâ”€â”€ FEATURES.md           # Feature development record
â”œâ”€â”€ LICENSE               # License file
â””â”€â”€ README.md             # Project description document
```

### Configuration Description

The configuration file `config/config.yaml` contains the following parameters:

```yaml
api_key: your_api_key_here
api_url: https://paddleocr-vl-api.example.com
use_doc_orientation_classify: true
use_doc_unwarping: true
use_chart_recognition: true
prettifyMarkdown: true
visualize: true
```

### Log Description

- Log files are saved in the `logs/` directory
- Log levels: DEBUG, INFO, WARNING, ERROR, CRITICAL
- Console outputs logs above DEBUG level
- Log files record logs above INFO level

### Version History

| Version | Date | Update Content |
|---------|------|----------------|
| v0.5 | 2025-12-01 | Initial version with all basic features |
| v0.6 | In development | Add Word file format automatic adjustment feature |

### Future Plans

| Feature Name | Description | Priority |
|--------------|-------------|----------|
| Area Screenshot Optimization | Optimize user experience of area screenshot | Medium |
| Shortcut Support | Add shortcuts for common operations | Medium |
| Multi-language Support | Support recognition and interface in multiple languages | Low |
| Batch Processing | Support batch file processing | High |
| Result Preview | Add preview function for recognition results | Medium |

### Contribution Guidelines

Welcome to contribute to the project, including:
- Fixing bugs
- Adding new features
- Optimizing code
- Improving documentation

### Contact Information

For questions or suggestions, please contact the project maintainer:
- GitHub Issues: https://github.com/edilyxin/office-desktop-assistant/issues

---

[Switch to Chinese Version](#ä¸­æ–‡ç‰ˆæœ¬)